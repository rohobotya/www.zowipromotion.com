<?php
// Simple login handler
if ($_SERVER["REQUEST_METHOD"] === "POST") {
    $email = $_POST["email"];
    $password = $_POST["password"];
    $found = false;

    if (($handle = fopen("users.csv", "r")) !== false) {
        while (($data = fgetcsv($handle)) !== false) {
            if ($data[2] === $email && password_verify($password, $data[3])) {
                $found = true;
                break;
            }
        }
        fclose($handle);
    }

    if ($found) {
        echo "<h2>Login successful!</h2><p>Welcome, $data[0]!</p><a href='index.html'>Go to Home</a>";
    } else {
        echo "<h2>Login failed.</h2><p>Invalid email or password. <a href='login.html'>Try again</a></p>";
    }
} else {
    header("Location: login.html");
    exit();
}
?>